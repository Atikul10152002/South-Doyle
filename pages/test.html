<!DOCTYPE html>
<html>

<head>
  <base target="_blank">
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="icon" href="https://github.com/South-Doyle/South-Doyle/blob/master/images/SDorgicon.png?raw=true">
  <title>Soknorobo upload</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/css/materialize.min.css">
  <style>
    body {
      background: #000;
      background-image:url("https://github.com/South-Doyle/South-Doyle/blob/master/images/hypnotize.png?raw=true");
      /*background-image: url("/Users/atikul/Documents/GitHub/South-Doyle/images/hypnotize.png");*/
      background-attachment: fixed;
    }

    .disclaimer {
      width: 480px;
      color: #646464;
      margin: 20px auto;
      padding: 0 16px;
      text-align: center;
      font: 400 12px Roboto, Helvetica, Arial, sans-serif
    }

    .disclaimer a {
      color: #009688
    }

    #credit {
      display: none
    }
    .center-align{
      text-align: center;
    }
  </style>
</head>

<body>

  <form class="main" id="form" novalidate="novalidate" style="max-width: 480px;margin: 40px auto;" autocomplete="on">
    <div id="forminner">
      <div class="row">
        <div class="col s12">
          <h5 class="center-align teal-text">Upload Files to Soknorobo</h5>
          <p class="disclaimer">Please use this field to submit SDHS Robotics related images, This <b><i>doesn't</i></b> guarantee your picture to be displayed on the website as it will be throughly reviewed by one of the contributor or mentor of the team. Thanks for contributing!</p>
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <input id="name" type="text" name="Name" class="validate" required autocomplete="name">
          <label for="name" required>Name</label>
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <input id="email" type="email" name="Email" class="validate" required>
          <label for="email" required>Email Address</label>
        </div>
      </div>

      <div class="row" style="color:#26a69a;">
        <div class="file-field input-field col s12">
          <div class="btn">
            <span>File</span>
            <input id="files" type="file" multiple>
          </div>
          <div class="file-path-wrapper">
            <input class="file-path validate" type="text" placeholder="Select files from your computer">
          </div>
        </div>
      </div>

      <div class="row">
        <div class="input-field col s6">
          <button class="waves-effect waves-light btn submit-btn" type="submit" onclick="submitForm(); return false;">Submit</button>

        </div>
      </div>
      <div class="row">
        <div class="input-field col s12" id="progress">
        </div>
      </div>
    </div>
    <div id="success" style="display:none">
      <p class="center-align teal-text">Thanks for your contribution</p>
      <p class="center-align"><a class="btn btn-large" href="https://script.google.com/a/student.knoxschools.org/macros/s/AKfycbz-PiadwHLL4TJQi_2v39xPgo_HUYf9pWnRvjq-S-c3QSKvhVY/exec">Upload another file</a></p>
    </div>
  </form>


  <div class="fixed-action-btn horizontal" style="bottom: 45px; right: 24px;">
    <a href="https://soknorobo.com/" class="btn-floating btn-large blue">
<i class="medium material-icons">arrow_back</i>
</a>
  </div>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.97.5/js/materialize.min.js"></script>

  <script>
    var file,
      reader = new FileReader();

    reader.onloadend = function(e) {
      if (e.target.error != null) {
        showError("File " + file.name + " could not be read.");
        return;
      } else {
        google.script.run
          .withSuccessHandler(showSuccess)
          .uploadFileToGoogleDrive(e.target.result, file.name, $('input#name').val(), $('input#email').val());
      }
    };

    function showSuccess(e) {
      if (e === "OK") {
        $('#forminner').hide();
        $('#success').show();
      } else {
        showError(e);
      }
    }

    function submitForm() {

      var files = $('#files')[0].files;

      if (files.length === 0) {
        showError("Please select a file to upload");
        return;
      }

      file = files[0];

      if (file.size > 1024 * 1024 * 10) {
        showError("The file exceeds the 10 Megabytes limit, Please upload another file");
        return;
      }

      showMessage("Uploading file..");
      reader.readAsDataURL(file);

    }

    function showError(e) {
      $('#progress').addClass('red-text').html(e);
    }

    function showMessage(e) {
      $('#progress').removeClass('red-text').html(e);
    }
  </script>

</body>

</html>
